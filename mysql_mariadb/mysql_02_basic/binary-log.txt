// https://dev.mysql.com/doc/refman/5.7/en/binary-log.html


binary log 二进制日志

binary log 有两个重要的用途：
- For replication 主从复制   https://dev.mysql.com/doc/refman/5.7/en/replication-implementation.html
- Certain data recovery operations require use of the binary log. 即恢复自上次backup后在binary log中新记录的event.  https://dev.mysql.com/doc/refman/5.7/en/point-in-time-recovery.html


// binary log不会记录select 和 show 语句，如果需要此功能(如测试环境中用于调试),可考虑使用general query log, 见 https://dev.mysql.com/doc/refman/5.7/en/query-log.html

// binary会降低单主机些许性能，但基于binary log的 replication 和  restore operations 其利大于弊

// 包含password的语句被记录到binary log时会被server重写而不会以纯文本的字面值存在 https://dev.mysql.com/doc/refman/5.7/en/password-logging.html

// 启用二进制日志功能：
//     二进制日志默认存放目录为data directory, 如果要改变默认目录，在base_name前以绝对路径作为前缀,
//     推荐( It is recommended)总是明确指定base_name二不只依赖默认使用的host name
--log-bin[=base_name]    #启用bin log功能是一定要明确指定base_name,不要依赖默认规则, 也不要执行后缀名(base_name.extension),因为指了也没用(因其会被悄悄删除和忽略掉)


mysqld追加数字扩展名到bin log日志的base name后以生成 binary log file names.
该数字随每次server创建一个新log file是而递增，因此产生了file names为有序系列的日志文件,
server产生或创建新的bin log的时机：
     1. 每次start时
     2. 每次flush the log时
     3. 当前bin log大小达到 max_binlog_size 时会自动创建新的bin log。
        注：实际中bin log的大小可能会超出 max_binlog_size 的大小(如果使用了很大的事务transactions)，
            因为事务绝不允许以片段的形式被切分写入多个文件中。(其实这也与事务acid中的atomic原子性相呼应)
// 原文:
// mysqld appends a numeric extension to the binary log base name to generate binary log file names.
// The number increases each time the server creates a new log file, thus creating an ordered series of files.
// The server creates a new file in the series each time it starts or flushes the logs.
// The server also creates a new binary log file automatically after the current log's size reaches max_binlog_size. 
// A binary log file may become larger than max_binlog_size if you are using large transactions
// because a transaction is written to the file in one piece, never split between files.

// https://dev.mysql.com/doc/refman/5.7/en/binary-log.html

为跟踪已经被使用了的bin log files, mysqld同时会创建a binary log index file来包含the names of the binary log files，
默认情况下其名字为<base name>.index, 当然可以通过 --log-bin-index[=file_name] 来修改名字，禁止在mysqld运行时手动
修改这个文件，否则会让 mysqld产生歧义

术语 “binary log file” 通常表示 一个独立的numbered file containing database events.
The term “binary log” collectively denotes the set of numbered binary log files plus the index file.


如果一个client有足够的权限，可以通过 SET sql_log_bin=OFF 在会话级别 禁止 binary log 功能
// 原文:
// A client that has privileges sufficient to set restricted session system variables (see Section 5.1.8.1, “System Variable Privileges”)
// can disable binary logging of its own statements by using a SET sql_log_bin=OFF statement.
























https://dev.mysql.com/doc/refman/5.7/en/replication-solutions-unexpected-slave-halt.html


